print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
##contig=<ID=chr19,length=53576266>
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
##contig=<ID=chr19,length=53576266>
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
##contig=<ID=chr19,length=53576266>
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_a1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
suppressMessages(library(ggplot2))
suppressMessages(library(devtools))
suppressMessages(library(BSgenome))
suppressMessages(library(MutationalPatterns))
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
suppressMessages(library(ref_genome, character.only = TRUE))
source("https://bioconductor.org/biocLite.R")
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
##contig=<ID=chr19,length=53576266>
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# cool little script that checks if ggplot3 is already installed and if not, installs it
list.of.packages <- c('ggplot2', 'devtools', 'lazyeval', 'NMF', 'tibble', 'formatR', 'rmarkdown')
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages, dep=TRUE)
suppressMessages(library(ggplot2))
suppressMessages(library(devtools))
suppressMessages(library(BSgenome))
suppressMessages(library(MutationalPatterns))
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
suppressMessages(library(ref_genome, character.only = TRUE))
source("https://bioconductor.org/biocLite.R")
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
##contig=<ID=chr19,length=53576266>
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_a1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_a1_0.75')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/nextseq_c1_0.75/')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/nextseq_c1_0.75/')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/nextSeq_c1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/nextSeq_c1/')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('nextf341', 'nextf342')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/stratton')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/stratton')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('colon1', 'colon2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT/')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT/')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('nextf341', 'nextf342')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/artificialGtoT/')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('GtoT1', 'GtoT2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/cord55')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/cord55')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('colon1', 'colon2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
# laptop
# setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/cord55')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/cord55')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('cord55_1', 'cord55_2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
setwd('/home/alex/Dropbox/Code/FERMI/varAlleleFrequency')
setwd('/home/alex/Dropbox/Code/FERMI/varAlleleFrequency')
vafs <- read.table("vafRepeatability.txt", header = TRUE)
counts_1 <- table(vafs$Sample1, vafs$Identity)
counts_2 <- table(vafs$Sample2, vafs$Identity)
barplot(counts_1, col = "red", xlab = "Identity", ylab = "Counts of Something", main = "Give this graph a nice title", beside = TRUE)
barplot(counts_1, col = "red", xlab = "Identity", ylab = "Counts of Something", main = "Give this graph a nice title", beside = TRUE)
barplot(head(counts_1), col = "red", xlab = "Identity", ylab = "Counts of Something", main = "Give this graph a nice title", beside = TRUE)
messy <- vafs %>%
gather(name2, vaf2, ID, locus, Sample2:Sample2:Identity:Identity)
head(messy)
library(tidyr)
setwd('/home/alex/Dropbox/Code/FERMI/varAlleleFrequency')
vafs <- read.table("vafRepeatability.txt", header = TRUE)
messy <- vafs %>%
gather(name2, vaf2, ID, locus, Sample2:Sample2:Identity:Identity)
messy <- data.frame(
name = c("Wilbur", "Petunia", "Gregory"),
a = c(67, 80, 64),
b = c(56, 90, 50)
)
messy
head(vafs)
messy$a
messy %>%
gather(drug, heartrate, a:b)
head(vafs)
messy <- vafs %>%
gather(name2, vaf2, Sample2:Identity)
messy
head(messy)
messy <- data.frame(
sample1 = c(vafs$Sample1),
sample2 = c(vafs$Sample2),
locus = c(vafs$Identity)
)
head(messy)
tidier <- messy %>%
gather(vaf2, locus, a:b)
tidier <- messy %>%
gather(vaf2, locus, sample2:locus)
head(tidier)
messy <- vafs %>%
gather(name2, vaf2, -id:Identity)
messy <- vafs %>%
gather(name2, vaf2, -sample2:Identity)
messy <- vafs %>%
gather(name2, vaf2, -sample2:Identity)
messy <- data.frame(
sample1 = c(vafs$Sample1),
sample2 = c(vafs$Sample2),
locus = c(vafs$Identity)
)
messy <- data.frame(
sample1 = c(vafs$Sample1),
sample2 = c(vafs$Sample2),
locus = c(vafs$Identity)
)
head(messy)
messy <- data.frame(
sample1 = c(vafs$Sample1),
sample2 = c(vafs$Sample2),
locus = c(vafs$Identity)
)
messy
vafs <- read.table("vafRepeatability.txt", header = TRUE)
head(vafs)
messy <- data.frame(
sample1 = c(vafs$Sample1),
sample2 = c(vafs$Sample2),
locus = c(vafs$Identity)
)
head(messy)
library(dplyr)
list.of.packages <- c("tidyr","dplyr") # cool little script that checks if ggplot2 is already installed and if not, installs it
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages, dep=TRUE)
library(tidyr)
library(dplyr)
setwd('/home/alex/Dropbox/Code/FERMI/varAlleleFrequency')
vafs <- read.table("vafRepeatability.txt", header = TRUE)
head(vafs)
filter(vafs, Sample2 < 0.0001)
filter(vafs, Sample2 < 0.0002)
head(filter(vafs, Sample2 < 0.0002))
head(vafs)
head(strsplit(vafs$Identity[0]))
head(strsplit(vafs$Identity[0]), '-')
head(strsplit(vafs$Identity[0]), "-")
strsplit('hello-there','-')
head(vafs)
strsplit('hello-there','-')[0]
strsplit('hello-there','-')[1]
x=strsplit('hello-there','-')
x
x[0]
x[1]
x=[1,2,3]
s = c("aa", "bb", "cc", "dd", "ee")
s[2]
s[0]
x
x[[1]]
x[[0]]
x[[2]]
noquote(strsplit("A text I want to display with spaces", NULL)[[1]])
x <- c(as = "asfef", qu = "qwerty", "yuiop[", "b", "stuff.blah.yech")
strsplit(x, "e")
x=strsplit('hello-there','-')
x
x[1][1]
x[1][1][1]
x[[1]]
x[[1]][1]
x[[1]][2]
x=strsplit('hello-there','-')[[1]][2]
x
mutate(vafs, Chrom = strsplit(Identity, '-')[[1]][1])
vasf
vafs
list.of.packages <- c('rmarkdown')
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages, dep=TRUE)
#library(swirl)
source("https://bioconductor.org/biocLite.R")
biocLite("BiocInstaller")
biocLite("BiocUpgrade")
source("https://bioconductor.org/biocLite.R")
biocLite()
biocLite('BSgenome')
biocLite('MutationalPatterns')
suppressMessages(library(BSgenome))
suppressMessages(library(MutationalPatterns))
available.genomes()
biocLite("BSgenome.Hsapiens.UCSC.hg19")
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
library(ref_genome, character.only = TRUE)
# change to working directory
setwd('/media/alex/Extra/Dropbox/Code/Sequencing/example_data')
setwd('/home/alex/Dropbox/Code/Sequencing/example_data')
# change to working directory
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/example_data')
setwd('/home/alex/Dropbox/Code/Sequencing/example_data')
vcf_files <- list.files(system.file("extdata", package="MutationalPatterns"),
pattern = ".vcf", full.names = TRUE)
sample_names = c("colon1", "colon2", "colon3",
"intestine1", "intestine2", "intestine3",
"liver1", "liver2", "liver3")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
auto <- extractSeqlevelsByGroup(species="Homo_sapiens",
style="UCSC",
group="auto")
vcfs <- lapply(vcfs, function(x) keepSeqlevels(x, auto))
head(mutations_from_vcf(vcfs[[1]]), 10)
head(mutation_types(vcfs[[1]]), 10)
# default plot
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# separate CpG sites
p2 <- plot_spectrum(type_occurrences, CT = TRUE)
plot(p2)
# plot with no legend
p3 <- plot_spectrum(type_occurrences, CT = TRUE, legend = FALSE)
plot(p3)
# separate each of the plots
library("gridExtra")
#grid.arrange(p1, p2, p3, ncol=3, widts=c(3,3,1.8))
# plot spectrum for each sample separately
tissue <- c(rep("colon", 3), rep("intestine", 3), rep("liver", 3))
p4 <- plot_spectrum(type_occurrences, by = tissue, CT = TRUE, legend = FALSE)
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1,4,7)])
head(mutation_context(vcfs[[1]], ref_genome), 10)
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c("55", "65", "75", "85", "95")
#vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:5)])
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
head(mutations_from_vcf(vcfs[[1]]), 10)
head(mutation_types(vcfs[[1]]), 10)
head(mutation_context(vcfs[[1]], ref_genome), 10)
mutation_context(vcfs[[1]], ref_genome)
contexts <- mutation_context(vcfs[[1]], ref_genome)
View(vafs)
View(contexts)
contexts
contexts('chr4')
contexts['chr4']
contexts['GGG']
type(contexts)
typeof(contexts)
x <- contexts
cwd()
write.table(x, '/home/alex/Desktop', sep='\t')
write.table(x, '/home/alex/Desktop/contexts.txt', sep='\t')
