rnorm(100, m=30, sd=10)
x=rnorm(100, m=30, sd=10)
plot(x)
hx= dnorm(x)
hx
plot(hx)
set.seed(3000)
xseq<-seq(-4,4,.01)
densities<-dnorm(xseq, 0,1)
cumulative<-pnorm(xseq, 0, 1)
randomdeviates<-rnorm(1000,0,1)
par(mfrow=c(1,3), mar=c(3,4,4,2))
plot(xseq, densities, col="darkgreen",xlab="", ylab="Density", type="l",lwd=2, cex=2, main="PDF of Standard Normal", cex.axis=.8)
xseq
densities
x=2^x
plot(xseq, densities, col="darkgreen",xlab="", ylab="Density", type="l",lwd=2, cex=2, main="PDF of Standard Normal", cex.axis=.8)
xz
x
xseq=2^xseq
densities<-dnorm(xseq, 0,1)
plot(xseq, densities, col="darkgreen",xlab="", ylab="Density", type="l",lwd=2, cex=2, main="PDF of Standard Normal", cex.axis=.8)
library(ggplot2)
library(devtools)
install.packages(devtools)
install.packages('devtools')
install.packages('devtools')
library(devtools)
install_github("UMCUgenetics/MutationalPatterns")
library(ggplot2)
library(devtools)
packages.install('devtools')
install.packages('devtools')
library('devtools')
library(devtools)
install_github("UMCUgenetics/MutationalPatterns")
source("https://bioconductor.org/biocLite.R")
biocLite("BiocInstaller")
biocLite("BiocUpgrade")
source("https://bioconductor.org/biocLite.R")
biocLite()
biocLite('BSgenome')
biocLite('MutationalPatterns')
biocLite('Biostrings')
library(devtools)
install_github("UMCUgenetics/MutationalPatterns")
library(devtools)
install_github("UMCUgenetics/MutationalPatterns")
install.packages('lazyeval')
install_github("UMCUgenetics/MutationalPatterns")
install.packages('NMF')
install.packages('NMF', dep = TRUE)
install.packages('lazyeval', dep=TRUE)
library(ggplot2)
install.packages('tibble', dep=TRUE)
library(ggplot2)
library(devtools)
install_github("UMCUgenetics/MutationalPatterns")
setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_a1_0.75/')
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
# laptop
setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'rep(seq, 4), 'Obs'=oncoSites$Obs)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
# laptop
setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiseq_f1_0.75')
oncoGenes <- read.table('oncoGenes.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoGenes$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoGenes') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
oncoSites <- read.table('oncoSites.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=oncoSites$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 OncoSites') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
TIIIRegions <- read.table('TIIIRegions.txt', header = TRUE)
seq=c("A", "C", "T", "G")
df=data.frame('Ref'=rep(seq, each=4), 'Var'=rep(seq, 4), 'Obs'=TIIIRegions$Obs)
ggplot(data=df) + aes(x=Var, y=Obs, title='C1-R1 TIIIRegions') +
geom_bar(stat='identity', position="dodge", fill="grey", color="black")  +
facet_grid(~Ref)
source("https://bioconductor.org/biocLite.R")
biocLite("BSgenome.Hsapiens.UCSC.hg19")
suppressMessages(library(ref_genome, devtools, BSgenome, MutationalPatterns, character.only = TRUE))
suppressMessages(library(MutationalPatterns))
suppressMessages(library(ref_genome, devtools, BSgenome, character.only = TRUE))
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
suppressMessages(library(ref_genome, devtools, BSgenome, character.only = TRUE))
library(devtools, BSgenome, MutationalPatterns, character.only = TRUE)
suppressMessages(library(devtools))
suppressMessages(library(BSgenome))
suppressMessages(library(MutationalPatterns))
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
suppressMessages(library(ref_genome, character.only = TRUE))
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
vcf_files
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
getwd()
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/')
getwd()
ls
list.files()
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
vcf_files
setwd(/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
list.files()
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
vcf_files
sample_names = c('hicord1', 'hicord2')
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
getwd()
list.files()
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
biocLite('MutationalPatterns')
suppressMessages(library(MutationalPatterns))
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
print(getwd())
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
install_github("UMCUgenetics/MutationalPatterns")
suppressMessages(library(MutationalPatterns))
suppressMessages(
print('hello')
)
suppressMessages(
library(MutationalPatterns)
)
suppressMessages(
library(devtools),
library(BSgenome),
library(MutationalPatterns)
)
suppressMessages(library(BSgenome))
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
temp <- GRanges(vcf_files)
temp <- GRanges(vcf_files, genome = "BSgenome.Hsapiens.UCSC.hg19")
plot_96_profile(mut_mat[,c(1:2)])
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
suppressMessages(setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1'))
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
source('~/Dropbox/Code/FERMI/baseChangeBias/baseChangeBias.R', echo=TRUE)
source('~/Dropbox/Code/FERMI/baseChangeBias/baseChangeBias.R', echo=TRUE)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hilymph1', 'hylymph2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
sessionInfo()
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
library(ref_genome, character.only = TRUE)
download_example_data <- function(data_dir, samples) {
dir.create(data_dir, recursive = TRUE, mode = "0755")
for (i in 1:length(samples)) {
download.file (paste("https://raw.githubusercontent.com/CuppenResearch/",
"MutationalPatterns-data/master/", samples[i], ".vcf",
sep=""), paste(data_dir, "/", samples[i], ".vcf", sep=""))
}
}
# Put the desired filenames in the following function
sample_names = c("colon1", "colon2", "colon3",
"intestine1", "intestine2", "intestine3",
"liver1", "liver2", "liver3")
download_example_data("example_data", sample_names)
vcf_files <- list.files(system.file("extdata", package="MutationalPatterns"),
pattern = ".vcf", full.names = TRUE)
sample_names = c("colon1", "colon2", "colon3",
"intestine1", "intestine2", "intestine3",
"liver1", "liver2", "liver3")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "BSgenome.Hsapiens.UCSC.hg19")
summary(vcfs)
auto <- extractSeqlevelsByGroup(species="Homo_sapiens",
style="UCSC",
group="auto")
vcfs <- lapply(vcfs, function(x) keepSeqlevels(x, auto))
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
vcf_files
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
# setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
# setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('colon1', 'colon2')
# sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
summary(vcfs)
# compute 96 mutation matrix
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(1:2)])
# count variant occurances across both samples
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
print(type_occurrences)
p1 <- plot_spectrum(type_occurrences)
plot(p1)
# laptop
#setwd('/media/alex/Extra/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
# desktop
# setwd('/home/alex/Dropbox/Code/Sequencing/4.25.2017_NextSeqvsHiSeq/hiSeq_f1')
print(getwd())
vcf_files <- list.files(pattern = ".vcf", full.names = TRUE)
sample_names = c('colon1', 'nextf341')
# sample_names = c('hicord1', 'hicord2')
# vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = "hg19")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
